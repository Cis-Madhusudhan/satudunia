$(document).ready(function(){$(".retag-link").live("click",function(){var a=$(this);return a.parent(".retag").hide(),a.parents(".tag-list").find(".tag").hide(),$.ajax({dataType:"json",type:"GET",url:a.attr("href"),extraParams:{format:"js"},success:function(b){b.success?(a.parents(".tag-list").before(b.html),$(".chosen-retag").ajaxChosen({method:"GET",url:"/questions/tags_for_autocomplete.js",dataType:"json"},function(a){var b={};return $.each(a,function(a,c){console.log("i: "+a),console.log("val: "+c),b[c.value]=c.caption}),b})):(Messages.show(b.message,"error"),b.status=="unauthenticate"&&(window.location="/users/login"))}}),!1}),$(".retag-form").live("submit",function(){form=$(this);var a=form.find("input[type=submit]");return a.attr("disabled",!0),$.ajax({url:form.attr("action")+".js",dataType:"json",type:"POST",data:form.serialize()+"&format=js",beforeSend:function(a,b){},success:function(a,b){if(a.success){var c=$.map(a.tags,function(a){return'<li><a class="tag" rel="tag" href="/questions/tags/'+a+'">'+a+"</a></li>"});form.next(".tag-list").find("li a.tag").remove(),form.next(".tag-list").prepend($.unique(c).join("")),form.remove(),console.log(c.join("")),$(".retag").show(),Messages.show(a.message,"notice")}else Messages.show(a.message,"error"),a.status=="unauthenticate"&&(window.location="/users/login")},error:Messages.ajax_error_handler,complete:function(b,c){a.attr("disabled",!1)}}),!1}),$(".cancel-retag").live("click",function(){var a=$(this),b=a.parents("form");return b.next(".tag-list").find(".tag").show(),b.next(".tag-list").find(".retag").show(),b.remove(),!1})});