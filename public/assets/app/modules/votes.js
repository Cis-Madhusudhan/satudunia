Votes=function(){function b(){}function c(){$(".quick-vote-button").live("click",function(a){var b=$(this);b.hide();var c=b.attr("src");if(c.indexOf("/images/dialog-ok.png")==0){var d=$(this).attr("name"),e=$(this).parents("form");$.post(e.attr("action"),e.serialize()+"&"+d+"=1",function(a){a.success?(b.parents(".item").find(".votes .counter").text(a.average),b.attr("src","/images/dialog-ok-apply.png"),Messages.show(a.message,"notice")):(Messages.show(a.message,"error"),a.status=="unauthenticate"&&(window.onbeforeunload=null,window.location="/users/login")),b.show()},"json")}return!1})}function d(){$(".answer").delegate("form.vote_form button","click",function(a){if(Ui.offline())Auth.startLoginDialog();else{var b=$(this).attr("name"),c=$(this).parents("form");$.post(c.attr("action")+".js",c.serialize()+"&"+b+"=1",function(a){a.success?(c.find(".votes_average").text(a.average),a.vote_state=="destroyed"?c.find("button").removeClass("checked"):(a.vote_state=="updated"&&c.find("button").removeClass("checked"),a.vote_type=="vote_down"?c.find("button.negative").addClass("checked"):c.find("button.positive").addClass("checked")),Messages.show(a.message,"notice")):(Messages.show(a.message,"error"),a.status=="unauthenticate"&&(window.onbeforeunload=null,window.location="/users/login"))},"json")}return!1})}function e(a){}function f(a){}var a=this;return{initialize:b,initializeOnQuestions:c,initializeOnQuestion:d,updateOnIndex:e,updateOnShow:f}}();