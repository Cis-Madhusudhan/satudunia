/**
 * Knob - jQuery Plugin
 * Downward compatible, touchable dial
 *
 * Version: 1.1.2 (22/05/2012)
 * Requires: jQuery v1.7+
 *
 * Copyright (c) 2011 Anthony Terrien
 * Under MIT and GPL licenses:
 *  http://www.opensource.org/licenses/mit-license.php
 *  http://www.gnu.org/licenses/gpl.html
 *
 * Thanks to vor, eskimoblood, spiffistan
 */
$(function(){function b(a){return $.isNumeric(a)?a*Math.PI/180:0}var a=function(b,c){var d=null,e=b[0].getContext("2d"),f=2*Math.PI,g,h,i,j,k=this;this.onChange=function(){},this.onCancel=function(){},this.onRelease=function(){},this.val=function(a){if(null==a){var b,e;return b=e=Math.atan2(g-i,-(h-j-c.width/2))-c.angleOffset,e<0&&(b=e+f),a=Math.round(b*(c.max-c.min)/f)+c.min,a>c.max?c.max:a}c.stopper&&(a=Math.max(Math.min(a,c.max),c.min)),d=a,this.onChange(a),c.dynamicDraw?this.dynamicDraw(a):this.draw(a)},this.change=function(a){c.stopper&&(a=Math.max(Math.min(a,c.max),c.min)),this.onChange(a),this.draw(a)},this.angle=function(a){return(a-c.min)*f/(c.max-c.min)},this.draw=function(b){var g=this.angle(b),h=1.5*Math.PI+c.angleOffset,i=h,j=h+this.angle(d),k=i+g,l=c.width/2,m=l*c.thickness,n=a.getCgColor(c.cgColor),o;e.clearRect(0,0,c.width,c.width),e.lineWidth=m;if(c.draw(g,d,c,e))return;for(o=0;o<c.ticks;o++){e.beginPath(),g>2*Math.PI/c.ticks*o&&c.tickColorizeValues?e.strokeStyle=c.fgColor:e.strokeStyle=c.tickColor;var p=2*Math.PI/c.ticks*o-.5*Math.PI;e.arc(l,l,l-m-c.tickLength,p,p+c.tickWidth,!1),e.stroke()}c.cursor&&(h=j-.3)&&(j+=.3)&&(i=k-.3)&&(k+=.3);switch(c.skin){case"default":e.beginPath(),e.strokeStyle=c.bgColor,e.arc(l,l,l-m/2,0,f,!0),e.stroke(),c.displayPrevious&&(e.beginPath(),e.strokeStyle=d==b?c.fgColor:n,e.arc(l,l,l-m/2,h,j,!1),e.stroke()),e.beginPath(),e.strokeStyle=c.fgColor,e.arc(l,l,l-m/2,i,k,!1),e.stroke();break;case"tron":c.displayPrevious&&(e.beginPath(),e.strokeStyle=d==b?c.fgColor:n,e.arc(l,l,l-m,h,j,!1),e.stroke()),e.beginPath(),e.strokeStyle=c.fgColor,e.arc(l,l,l-m,i,k,!1),e.stroke(),e.lineWidth=2,e.beginPath(),e.strokeStyle=c.fgColor,e.arc(l,l,l-m+1+m*2/3,0,2*Math.PI,!1),e.stroke()}};var l,m;this.dynamicDraw=function(a){var b=this;l=c.min,m=setInterval(function(){b.animateDraw(a)},20)},this.animateDraw=function(){l>d?(clearInterval(m),d=l):(this.draw(l),this.change(l),l++)},this.capture=function(a){switch(a.type){case"mousemove":case"mousedown":g=a.pageX,h=a.pageY;break;case"touchmove":case"touchstart":g=a.originalEvent.touches[0].pageX,h=a.originalEvent.touches[0].pageY}this.change(this.val())},this.cancel=function(){k.val(d),k.onCancel()},this.startDrag=function(a){var e=b.offset(),f=$(document);i=e.left+c.width/2,j=e.top,this.capture(a),f.bind("mousemove.dial touchmove.dial",function(a){k.capture(a)}).bind("keyup.dial",function(a){a.keyCode===27&&(f.unbind("mouseup.dial mousemove.dial keyup.dial"),k.cancel())}).bind("mouseup.dial touchend.dial",function(a){f.unbind("mousemove.dial touchmove.dial mouseup.dial touchend.dial keyup.dial"),k.val(k.val()),k.onRelease(d)})}};a.getCgColor=function(a){a=a.substring(1,7);var b=[parseInt(a.substring(0,2),16),parseInt(a.substring(2,4),16),parseInt(a.substring(4,6),16)];return"rgba("+b[0]+","+b[1]+","+b[2]+",.5)"},$.fn.knob=$.fn.dial=function(c){return this.each(function(){var d=$(this),e;if(d.data("dialed"))return d;d.data("dialed",!0),e=$.extend({min:d.data("min")||0,max:d.data("max")||100,stopper:!0,readOnly:d.data("readonly"),cursor:d.data("cursor"),thickness:d.data("thickness")||.35,width:d.data("width")||200,displayInput:d.data("displayinput")==null||d.data("displayinput"),displayPrevious:d.data("displayprevious"),fgColor:d.data("fgcolor")||"#87CEEB",cgColor:d.data("cgcolor")||d.data("fgcolor")||"#87CEEB",bgColor:d.data("bgcolor")||"#EEEEEE",tickColor:d.data("tickColor")||d.data("fgcolor")||"#DDDDDD",ticks:d.data("ticks")||0,tickLength:d.data("tickLength")||0,tickWidth:d.data("tickWidth")||.02,tickColorizeValues:d.data("tickColorizeValues")||!0,skin:d.data("skin")||"default",angleOffset:b(d.data("angleoffset")),dynamicDraw:d.data("dynamicdraw")||!1,draw:function(a,b,c,d){},change:function(a){},release:function(a,b){}},c);var f=$('<canvas width="'+e.width+'" height="'+e.width+'"></canvas>'),g=$("<div style=width:"+e.width+'px;display:inline;"></div>'),h,i=d.val(),j=function(){e.displayInput&&d.css({width:e.width/2+"px",position:"absolute","margin-top":e.width*5/14+"px","margin-left":"-"+e.width*3/4+"px","font-size":e.width/4+"px",border:"none",background:"none","font-family":"Arial","font-weight":"bold","text-align":"center",color:e.fgColor,padding:"0px","-webkit-appearance":"none"})||d.css({width:"0px",visibility:"hidden"})};d.wrap(g).before(f),j(),h=new a(f,e),i||(i=e.min),d.val(i),h.val(i),h.onRelease=function(a){e.release(a,d)},h.onChange=function(a){d.val(a),e.change(a)},d.bind("change",function(a){h.val(d.val())});if(!e.readOnly){f.bind("mousedown touchstart",function(a){a.preventDefault(),h.startDrag(a)}).bind("mousewheel DOMMouseScroll",mw=function(a){a.preventDefault();var b=a.originalEvent,c=b.detail||b.wheelDeltaX,e=b.detail||b.wheelDeltaY,f=parseInt(d.val())+(c>0||e>0?1:c<0||e<0?-1:0);h.val(f)});var k,l,m,n=1,o={37:-1,38:1,39:1,40:-1};d.bind("configure",function(a,b){var c;for(c in b)e[c]=b[c];j(),h.val(d.val())}).bind("keydown",function(a){var b=a.keyCode;b>=96&&b<=105&&(b-=48),k=parseInt(String.fromCharCode(b)),isNaN(k)&&(b!==13&&b!==8&&b!==9&&b!==189&&a.preventDefault(),$.inArray(b,[37,38,39,40])>-1&&(h.change(parseInt(d.val())+o[b]*n),m=window.setTimeout(function(){n<20&&n++},50),a.preventDefault()))}).bind("keyup",function(a){isNaN(k)?m?(window.clearTimeout(m),m=null,n=1,h.val(d.val()),h.onRelease(d.val(),d)):a.keyCode===13&&h.onRelease(d.val(),d):d.val()>e.max&&d.val(e.max)||d.val()<e.min&&d.val(e.min)}).bind("mousewheel DOMMouseScroll",mw)}else d.attr("readonly","readonly")}).parent()}});